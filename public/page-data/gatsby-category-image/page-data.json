{"componentChunkName":"component---src-templates-post-js","path":"/gatsby-category-image/","result":{"data":{"markdownRemark":{"id":"dcaf61fe-7187-5d85-90c1-6bb25472385f","excerpt":"ブログ記事にカテゴリーのアイコンを表示させました。  【やりたかったこと】 各記事にはカテゴリーが一つ設定されている 記事一覧にカテゴリー画像を表示する gatsby-imageで画像を表示させたい 【参考記事】 パスを渡せばgatsby-imageで画像を表示してくれるコンポーネントの作成方法 Easy Gatsby…","tableOfContents":"<ul>\n<li><a href=\"/gatsby-category-image/#gatsby-config%E3%81%AE%E8%A8%AD%E5%AE%9A\">Gatsby-configの設定</a></li>\n<li><a href=\"/gatsby-category-image/#%E3%82%AB%E3%83%86%E3%82%B4%E3%83%AA%E3%83%BC%E7%94%BB%E5%83%8F%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88\">カテゴリー画像を表示するコンポーネント</a></li>\n<li>\n<p><a href=\"/gatsby-category-image/#%E3%82%AB%E3%83%86%E3%82%B4%E3%83%AA%E3%83%BC%E7%94%BB%E5%83%8F%E8%A1%A8%E7%A4%BA%E7%94%A8%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E3%82%8B\">カテゴリー画像表示用のコンポーネントを作る</a></p>\n<ul>\n<li><a href=\"/gatsby-category-image/#a-%E7%94%BB%E5%83%8F%E5%90%8D%E3%82%92%E5%8F%97%E3%81%91%E5%8F%96%E3%81%A3%E3%81%A6%E3%80%81%E7%94%BB%E5%83%8F%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88\">A: 画像名を受け取って、画像を表示するコンポーネント</a></li>\n<li><a href=\"/gatsby-category-image/#b-%E3%82%AB%E3%83%86%E3%82%B4%E3%83%AA%E3%83%BC%E5%90%8D%E3%82%92%E5%8F%97%E3%81%91%E5%8F%96%E3%81%A3%E3%81%A6%E3%80%81%E3%82%AB%E3%83%86%E3%82%B4%E3%83%AA%E3%83%BC%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88\">B: カテゴリー名を受け取って、カテゴリー表示するコンポーネント</a></li>\n</ul>\n</li>\n<li><a href=\"/gatsby-category-image/#category%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%BF%E3%81%86%E3%81%A8%E3%81%8D\">Categoryコンポーネントを使うとき</a></li>\n</ul>","html":"<p>ブログ記事にカテゴリーのアイコンを表示させました。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAd1bAH//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAQQEQMYH/2gAIAQEAAT8henSB3//aAAwDAQACAAMAAAAQTD//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPxBn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAwADAQAAAAAAAAAAAAAAAAERITFxgf/aAAgBAQABPxCvZJ0Suq9MEJKsESEf/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"カテゴリー画像の格納場所\"\n        title=\"カテゴリー画像の格納場所\"\n        src=\"/static/eb5c4d575595af2c4095ced7d531668a/4b190/ss-gatsby-image-02.jpg\"\n        srcset=\"/static/eb5c4d575595af2c4095ced7d531668a/e07e9/ss-gatsby-image-02.jpg 200w,\n/static/eb5c4d575595af2c4095ced7d531668a/066f9/ss-gatsby-image-02.jpg 400w,\n/static/eb5c4d575595af2c4095ced7d531668a/4b190/ss-gatsby-image-02.jpg 800w,\n/static/eb5c4d575595af2c4095ced7d531668a/e5166/ss-gatsby-image-02.jpg 1200w,\n/static/eb5c4d575595af2c4095ced7d531668a/b17f8/ss-gatsby-image-02.jpg 1600w,\n/static/eb5c4d575595af2c4095ced7d531668a/5e0ab/ss-gatsby-image-02.jpg 1786w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>【やりたかったこと】</p>\n<ul>\n<li>各記事にはカテゴリーが一つ設定されている</li>\n<li>記事一覧にカテゴリー画像を表示する</li>\n<li>gatsby-imageで画像を表示させたい</li>\n</ul>\n<p>【参考記事】</p>\n<ul>\n<li><a href=\"https://takumon.com/simple-gatsby-image-wrapper/\" target=\"_blank\" rel=\"noopener noreferrer\">パスを渡せばgatsby-imageで画像を表示してくれるコンポーネントの作成方法</a></li>\n<li><a href=\"https://noahgilmore.com/blog/easy-gatsby-image-components/\" target=\"_blank\" rel=\"noopener noreferrer\">Easy Gatsby Image Components</a></li>\n</ul>\n<h2 id=\"gatsby-configの設定\" style=\"position:relative;\">Gatsby-configの設定</h2>\n<p>カテゴリー画像をフォルダに入れます。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdwpkjD/xAAZEAABBQAAAAAAAAAAAAAAAAAAARESIDH/2gAIAQEAAQUC0ig1P//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABICH/2gAIAQEABj8CMU//xAAaEAACAwEBAAAAAAAAAAAAAAAAAREhMRBR/9oACAEBAAE/IVpVBGqE/YKCzjP/2gAMAwEAAgADAAAAEBvP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Qp//EABoQAAIDAQEAAAAAAAAAAAAAAAERACExURD/2gAIAQEAAT8QVsFg1KjDIDiABq7BRLvmp//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"カテゴリー画像の格納場所\"\n        title=\"カテゴリー画像の格納場所\"\n        src=\"/static/cb641796c22cbb5a76fa2d236c728de5/4b190/ss-gatsby-image-01.jpg\"\n        srcset=\"/static/cb641796c22cbb5a76fa2d236c728de5/e07e9/ss-gatsby-image-01.jpg 200w,\n/static/cb641796c22cbb5a76fa2d236c728de5/066f9/ss-gatsby-image-01.jpg 400w,\n/static/cb641796c22cbb5a76fa2d236c728de5/4b190/ss-gatsby-image-01.jpg 800w,\n/static/cb641796c22cbb5a76fa2d236c728de5/e5166/ss-gatsby-image-01.jpg 1200w,\n/static/cb641796c22cbb5a76fa2d236c728de5/ca142/ss-gatsby-image-01.jpg 1285w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>プラグインにgatsby-source-filesystemを利用し、画像の格納場所を設定します。</p>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-source-filesystem</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/content/assets</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">assets</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-transformer-sharp</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-plugin-sharp</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n\n        <span class=\"token punctuation\">(</span>以下省略<span class=\"token punctuation\">)</span>\n\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>そして、サイトメタデータには、カテゴリーの一覧を設定します。\n項目は名前（name）とスラッグ（slug）と画像URL（image）の３つです。</p>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  siteMetadata<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token punctuation\">(</span>titleやsiteUrlなどいろいろ<span class=\"token punctuation\">)</span>\n\n    categories<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Programming</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        slug<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">programming</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        image<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">cat_programming.png</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Design</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        slug<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">design</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        image<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">cat_design.png</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">WordPress</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        slug<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">wordpress</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        image<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">cat_wordpress.png</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Column</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        slug<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">column</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        image<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">cat_column.png</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n        <span class=\"token punctuation\">(</span>以下省略<span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"カテゴリー画像を表示するコンポーネント\" style=\"position:relative;\">カテゴリー画像を表示するコンポーネント</h2>\n<p>まず、GraphQLでassetsに保存した画像を取得するクエリを書きます。</p>\n<p><code class=\"language-text\">http://localhost:8000/___graphql</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{\n  images: allFile(\n    filter: {extension: {eq: &quot;png&quot;},\n    sourceInstanceName: {eq: &quot;assets&quot;}}\n    ) {\n    edges {\n      node {\n        childImageSharp {\n          fluid(maxWidth: 800) {\n            originalName\n          }\n        }\n        name\n        relativePath\n      }\n    }\n  }\n}</code></pre></div>\n<p><code class=\"language-text\">sourceInstanceName: {eq: &quot;assets&quot;}</code>で、gatsby-configに指定した、ファイル格納場所のnameを設定すると画像フォルダに絞り込めます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3ogUf//EABUQAQEAAAAAAAAAAAAAAAAAABAR/9oACAEBAAEFAo1//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFxABAQEBAAAAAAAAAAAAAAAAAQAQMf/aAAgBAQABPyEj2YM5/9oADAMBAAIAAwAAABAwz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQEAAwEBAAAAAAAAAAAAAAEAESExUYH/2gAIAQEAAT8QDwxAND5DfJGsMzIxy//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"GraphQL\"\n        title=\"GraphQL\"\n        src=\"/static/677bed8b665eb2f5b2f12e920d64288d/4b190/ss-gatsby-image-03.jpg\"\n        srcset=\"/static/677bed8b665eb2f5b2f12e920d64288d/e07e9/ss-gatsby-image-03.jpg 200w,\n/static/677bed8b665eb2f5b2f12e920d64288d/066f9/ss-gatsby-image-03.jpg 400w,\n/static/677bed8b665eb2f5b2f12e920d64288d/4b190/ss-gatsby-image-03.jpg 800w,\n/static/677bed8b665eb2f5b2f12e920d64288d/e5166/ss-gatsby-image-03.jpg 1200w,\n/static/677bed8b665eb2f5b2f12e920d64288d/b17f8/ss-gatsby-image-03.jpg 1600w,\n/static/677bed8b665eb2f5b2f12e920d64288d/2ddb8/ss-gatsby-image-03.jpg 1923w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>こんな感じで取得できました。</p>\n<h2 id=\"カテゴリー画像表示用のコンポーネントを作る\" style=\"position:relative;\">カテゴリー画像表示用のコンポーネントを作る</h2>\n<p>二つのコンポーネントを用意します。</p>\n<p>A: 画像名を受け取って、画像を表示するコンポーネント</p>\n<p>B: カテゴリー名を受け取って、カテゴリー表示するコンポーネント</p>\n<h3 id=\"a-画像名を受け取って、画像を表示するコンポーネント\" style=\"position:relative;\">A: 画像名を受け取って、画像を表示するコンポーネント</h3>\n<div class=\"gatsby-code-title\">src/components/categoryimage.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useStaticQuery<span class=\"token punctuation\">,</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"gatsby\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Img <span class=\"token keyword\">from</span> <span class=\"token string\">\"gatsby-image\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> catImages <span class=\"token operator\">=</span> <span class=\"token function\">useStaticQuery</span><span class=\"token punctuation\">(</span>graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    query {\n      allFile(\n        filter: {\n          extension: {eq: \"png\"},\n          sourceInstanceName: {eq: \"assets\"}\n        })\n      {\n        edges {\n          node {\n            name\n            relativePath\n            childImageSharp {\n              fluid(maxWidth: 800) {\n                ...GatsbyImageSharpFluid_withWebp\n              }\n            }\n          }\n        }\n      }\n    }\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> image <span class=\"token operator\">=</span> catImages<span class=\"token punctuation\">.</span>allFile<span class=\"token punctuation\">.</span>edges<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> n<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>relativePath<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span>filename<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>image<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> imageFluid <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>childImageSharp<span class=\"token punctuation\">.</span>fluid\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Img\n      fluid<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>imageFluid<span class=\"token punctuation\">}</span>\n      alt<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>alt<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>クエリには、先ほどGraphQLで使ったクエリを設定します。\nfluidのところは下記のようにFragmentに置き換えます。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">fluid(maxWidth: 800) {\n  ...GatsbyImageSharpFluid_withWebp\n}</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">const image = catImages.allFile.edges.find(n =&gt; {\n    return n.node.relativePath.includes(props.filename)\n  });</code></pre></div>\n<p>取得したカテゴリー画像リストから、画像名が一致するものをimageに設定しています。</p>\n<h3 id=\"b-カテゴリー名を受け取って、カテゴリー表示するコンポーネント\" style=\"position:relative;\">B: カテゴリー名を受け取って、カテゴリー表示するコンポーネント</h3>\n<div class=\"gatsby-code-title\">src/components/category.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Link<span class=\"token punctuation\">,</span> useStaticQuery<span class=\"token punctuation\">,</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"gatsby\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Image <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/categoryimage\"</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Category</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> site <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useStaticQuery</span><span class=\"token punctuation\">(</span>\n    graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n      query {\n        site {\n          siteMetadata {\n            categories {\n              name\n              slug\n              image\n            }\n          }\n        }\n      }\n    </span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> category <span class=\"token operator\">=</span> site<span class=\"token punctuation\">.</span>siteMetadata<span class=\"token punctuation\">.</span>categories<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cat</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> cat<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> name<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/category/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>category<span class=\"token punctuation\">.</span>slug<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span>\n      key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>category<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span> <span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Image filename<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>category<span class=\"token punctuation\">.</span>image<span class=\"token punctuation\">}</span> alt<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>category<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>span className<span class=\"token operator\">=</span><span class=\"token string\">\"category-text pc\"</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>category<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Category</code></pre></div>\n<p>クエリでは、サイトメタデータからカテゴリーのリストを取得しています。</p>\n<p>名前が一致するカテゴリーを抜き出して、</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">const category = site.siteMetadata.categories.find((cat) =&gt; cat.name === name)</code></pre></div>\n<p>カテゴリーへのリンクを作ります。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;Link to={`/category/${category.slug}`}\n  key={category.name} &gt;\n  &lt;Image filename={category.image} alt={category.name}/&gt;\n  &lt;span className=&quot;category-text pc&quot;&gt;{category.name}&lt;/span&gt;\n&lt;/Link&gt;</code></pre></div>\n<p>画像を表示させる部分はAのコンポーネントを呼び出しています。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;Image filename={category.image} alt={category.name}/&gt;</code></pre></div>\n<h2 id=\"categoryコンポーネントを使うとき\" style=\"position:relative;\">Categoryコンポーネントを使うとき</h2>\n<p>Categoryをインポートして、</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import Category from &quot;../components/category&quot;</code></pre></div>\n<p>カテゴリーを表示させたい箇所で、namenいカテゴリー名を指定して、呼び出します。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;Category name= &quot;Programming&quot; /&gt;</code></pre></div>\n<p>このブログは、<a href=\"https://github.com/emmieworks/gatsby-zefoforest\">GitHub</a>でソースを公開しています。</p>","frontmatter":{"title":"【Gatsby】ブログのカテゴリー画像を表示させる","date":"2020/07/18","updateDate":null,"description":null,"category":"WebNote","tags":["Gatsby"],"featured":null}}},"pageContext":{"slug":"/gatsby-category-image/","prev":{"fields":{"slug":"/gatsby-netlify/"},"frontmatter":{"title":"Netlifyを使って、Gatsby.jsブログを独自ドメインで公開する手順"}},"next":{"fields":{"slug":"/hamburger-menu/"},"frontmatter":{"title":"CSSとJavaScriptで作るハンバーガーメニュー"}}}},"staticQueryHashes":["1941199855","3628787746","4032985131"]}